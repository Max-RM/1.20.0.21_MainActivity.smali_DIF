# 1.20.0.21_MainActivity.smali_DIF

English translate: https://github.com/Max-RM/1.20.0.21_MainActivity.smali_DIF/blob/main/readme_en.md

Примерная инструкция, чтобы заставить MCBE хранить миры по старому пути: ``/storage/emulated/0/games/com.mojang/minecraftWorlds``, а не ``.../Android/data/...``

Спасибо inotflying (Egornya) за изобретение этого метода.

02.05.2023 я научился создавать MCBE apk которые используют старый путь хранения миров - /storage/emulated/0/games/com.mojang/minecraftWorlds
Вместо нового /storage/emulated/0/Android/data/com.mojang.minecraftpe/files/games/com.mojang/minecraftWorlds

Смысл? - Из-за ограничений Android 13 теперь вы (если у вас нет root доступа) не можете изменять файлы находящиеся в папках  .../Android/data... Даже если вы используете сторонние проводники (хотя есть вероятность, что какие-то проводники нашли обходные пути, но сейчас не об этом)
Смысл в том, что и Blocktopograph, один из лучших NBT редакторов для Android теперь не может редактировать миры находящиеся там. Это так-же относиться к проекту NEFA и я был обязан найти пути решения проблем.
Здесь на помощь и приходит этот репозиторий. Используя информацию в нëм вы можете лично отредактировать apk MCBE и заставить его хранить миры по старому пути.

Сначала возьмите apk MCBE (предполагается, что он у вас уже есть) декомпилируйте его используя Apktool M https://4pda.to/forum/index.php?showtopic=1002506
Перейдите по пути /smali/com/mojang/minecraftpe находясь в папке декомпилированного apk, найдите файл  MainActivity.smali и внесите в него изменения типо этих: https://github.com/Max-RM/1.20.0.21_MainActivity.smali_DIF/commit/97d794adef66fb586103744ae0a33e090c136b74
То есть просто выполните изменения на основе показанных по ссылке.
Потом в Android.manifest.xml игры внесите такие изменения: https://ibb.co/mHyRWZ3 то есть вставьте строку: 

``<uses-permission 
    	android:name="android.permission.MANAGE_EXTERNAL_STORAGE" />``

(дополнено 21.07.2024):
Обязательно измените целевую SDK на 28 (Android 9 Pie)
и измените минимальную SDK на 1 или 23 (Android 1.0 или Android 6 Marshmallow)
Это можно сделать отредактировав файл apktool.json в самых нижних строках или после компиляции apk выполнить "Быстрое редактирование" и поменять SDK на нужные. Желательно не делать минимальную SDK - 1 потому что это может вызвать ошибки установки на Android 15.

Если эти шаги не выполнить, то в Android 14 в странице настроек приложения просто не появится возможность активации разрешения на специальный доступ к файлам.

после чего начните компиляцию в apktool M.

После установки игры в настройках активируйте доступ к файлам иначе игра не будет работать или не сможет создать новый мир.
